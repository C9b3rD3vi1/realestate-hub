<!-- Neighborhood Features -->
<section id="neighborhood" class="mt-10 fade-in-up flex flex-col items-center">
  <h2 class="text-xl sm:text-2xl font-bold text-primary mb-6 text-center">Neighborhood Features</h2>

  {% regroup neighborhood_features by category as grouped_features %}

  <div class="space-y-4 w-full max-w-6xl"> <!-- limits width for better centering -->
    {% for group in grouped_features %}
    <div class="collapse collapse-arrow bg-base-100 shadow-md rounded-xl overflow-hidden fade-in-up mx-auto">
      <input type="checkbox" id="collapse-{{ forloop.counter }}">
      <div class="collapse-title text-lg font-semibold capitalize flex items-center gap-2 justify-center">
        <i class="{{ group.list.0.get_icon }} text-primary"></i>
        {{ group.grouper }}
      </div>
      <div class="collapse-content">
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 justify-items-center stagger-container">
          {% for feature in group.list %}
          <div class="card bg-base-100 border shadow-sm hover:shadow-xl transition-all duration-500 rounded-lg overflow-hidden w-full max-w-xs stagger-item">
            <div class="card-body p-4">
              <!-- Icon + Title -->
              <div class="flex items-start gap-3">
                <div class="flex-shrink-0 w-10 h-10 rounded-full bg-primary/10 text-primary grid place-items-center">
                  <i class="{{ feature.get_icon }} text-lg"></i>
                </div>
                <div class="min-w-0">
                  <h3 class="text-base font-semibold text-base-content truncate">
                    {{ feature.name }}
                  </h3>
                  {% if feature.distance %}
                    <p class="text-xs text-base-content/70 mt-1">~ {{ feature.distance }}</p>
                  {% endif %}
                </div>
              </div>

              <!-- Optional map link -->
              {% if feature.map_url %}
              <div class="mt-3 text-center">
                <a href="{{ feature.map_url }}" target="_blank" rel="noopener noreferrer"
                   class="link link-primary text-sm inline-flex items-center gap-1">
                  View on map
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M13 7h4m0 0v4m0-4L10 14" />
                  </svg>
                </a>
              </div>
              {% endif %}
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
    {% empty %}
      <div class="col-span-full text-center text-gray-500 py-8">
        No neighborhood features listed.
      </div>
    {% endfor %}
  </div>
</section>
