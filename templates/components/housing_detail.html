{% extends 'base.html' %}
{% block title %}{{ house.title }} - Property Details{% endblock %}

{% block content %}
<section class="min-h-screen bg-gradient-to-br from-base-100 to-base-200 py-8 px-4 sm:px-6 lg:px-8">
  <div class="max-w-7xl mx-auto">
    <!-- Breadcrumbs -->
    <div class="text-sm breadcrumbs mb-6">
      <ul>
        <li><a href="{% url 'home' %}" class="text-primary hover:text-primary-focus">Home</a></li> 
        <li><a href="{% url 'listing' %}" class="text-primary hover:text-primary-focus">Properties</a></li>
        <li class="text-base-content/70">{{ house.title|truncatechars:20 }}</li>
      </ul>
    </div>

    <!-- Main Card -->
    <div class="bg-base-100 rounded-box shadow-xl overflow-hidden transition-all duration-300 hover:shadow-2xl">
      <div class="grid md:grid-cols-2 gap-0">
        <!-- Image Gallery with Thumbnails and Auto-scrolling -->
        <div class="relative group">
          <!-- Main Image Carousel -->
          <div class="carousel w-full h-64 sm:h-80 md:h-96" id="propertyCarousel">
            {% for image in house.images.all %}
            <div id="slide{{ forloop.counter }}" class="carousel-item relative w-full">
              <img src="{{ image.image.url }}" alt="Property Image {{ forloop.counter }}" 
                   class="w-full h-full object-cover"/>
              <div class="absolute flex justify-between transform -translate-y-1/2 left-5 right-5 top-1/2">
                <a href="#slide{% if forloop.first %}{{ house.images.count }}{% else %}{{ forloop.counter|add:'-1' }}{% endif %}" 
                   class="btn btn-circle btn-sm opacity-70 hover:opacity-100">❮</a> 
                <a href="#slide{% if forloop.last %}1{% else %}{{ forloop.counter|add:'1' }}{% endif %}" 
                   class="btn btn-circle btn-sm opacity-70 hover:opacity-100">❯</a>
              </div>
            </div>
            {% endfor %}
          </div>
          
          <!-- Thumbnail Strip -->
          <div class="flex space-x-2 mt-3 overflow-x-auto py-2 px-2">
            {% for image in house.images.all %}
              <a href="#slide{{ forloop.counter }}" class="flex-none">
                <img src="{{ image.image.url }}" 
                     class="w-16 h-16 object-cover rounded cursor-pointer border-2 border-transparent hover:border-primary transition-all"/>
              </a>
            {% endfor %}
          </div>
          
          <!-- Auto-scroll Controls -->
          <div class="flex justify-center space-x-2 mt-2">
            <button onclick="pauseAutoScroll()" class="btn btn-xs btn-circle">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </button>
            <button onclick="startAutoScroll()" class="btn btn-xs btn-circle">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
              </svg>
            </button>
          </div>
          
          <!-- Image Badges -->
          <div class="absolute top-4 left-4 flex flex-col space-y-2">
            <div class="badge badge-lg badge-primary animate-pulse">
              {{ house.get_house_type_display }}
            </div>
            <div class="badge badge-lg {% if house.is_available %}badge-success{% else %}badge-error{% endif %} animate-bounce">
              {% if house.is_available %}Available{% else %}Not Available{% endif %}
            </div>
          </div>
          
          <!-- Favorite Button -->
          <button class="absolute top-4 right-4 btn btn-circle btn-ghost text-white hover:bg-error hover:text-error-content">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
            </svg>
          </button>
        </div>

        <!-- House Details -->
        <div class="p-6 sm:p-8">
          <div class="flex justify-between items-start">
            <div>
              <h1 class="text-3xl sm:text-4xl font-bold text-primary mb-1 animate-fade-in">
                {{ house.title }}
              </h1>
              <div class="flex items-center text-sm text-gray-500 mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
                <span class="font-medium">{{ house.location }}</span>
              </div>
            </div>
            
            <div class="text-right">
              <div class="text-2xl sm:text-3xl font-bold text-success mb-1">
                KSh {{ house.price|floatformat:2 }}
              </div>
              <div class="text-xs text-gray-500">Price</div>
            </div>
          </div>

          <!-- Features Grid -->
          <div class="grid grid-cols-2 sm:grid-cols-3 gap-4 my-6">
            <div class="flex items-center space-x-2">
              <div class="p-2 rounded-full bg-primary/10 text-primary">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                </svg>
              </div>
              <div>
                <div class="font-bold">{{ house.size }}</div>
                <div class="text-xs text-gray-500">Size</div>
              </div>
            </div>
            
            <div class="flex items-center space-x-2">
              <div class="p-2 rounded-full bg-secondary/10 text-secondary">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
              </div>
              <div>
                <div class="font-bold">{{ house.bedrooms }}</div>
                <div class="text-xs text-gray-500">Bedrooms</div>
              </div>
            </div>
            
            <div class="flex items-center space-x-2">
              <div class="p-2 rounded-full bg-accent/10 text-accent">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                </svg>
              </div>
              <div>
                <div class="font-bold">{{ house.bathrooms }}</div>
                <div class="text-xs text-gray-500">Bathrooms</div>
              </div>
            </div>
          </div>

          <!-- Description -->
          <div class="prose max-w-none mb-6">
            <h3 class="text-lg font-semibold mb-2">Description</h3>
            <p class="text-base-content/80">{{ house.description }}</p>
          </div>

          <!-- Amenities -->
          <div class="mb-6">
            <h3 class="text-lg font-semibold mb-3">Amenities</h3>
            <div class="flex flex-wrap gap-2">
              {% for amenity in house.amenities.all %}
              <span class="badge badge-outline hover:badge-primary transition-colors">{{ amenity.name }}</span>
              {% empty %}
              <span class="text-gray-500">No amenities listed</span>
              {% endfor %}
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="flex flex-col sm:flex-row gap-3 mt-8">
            <a href="#contactForm" class="btn btn-primary btn-wide gap-2 transition-all hover:scale-105">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
              </svg>
              Contact Owner
            </a>
            
            <div class="dropdown dropdown-end dropdown-hover">
              <button class="btn btn-outline btn-wide gap-2 transition-all hover:scale-105">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z" />
                </svg>
                Share
              </button>
              <ul class="dropdown-content menu p-2 shadow bg-base-100 rounded-box w-52">
                <li><a onclick="shareOnFacebook()"><span class="text-blue-600">Facebook</span></a></li>
                <li><a onclick="shareOnTwitter()"><span class="text-sky-400">Twitter</span></a></li>
                <li><a onclick="shareOnInstagram()"><span class="text-pink-600">Instagram</span></a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Floating Interactive Map -->
    <div class="sticky top-4 z-10 mt-6">
      <div class="card bg-base-200 shadow-xl">
        <div class="card-body p-4">
          <div class="flex justify-between items-center">
            <h3 class="card-title text-lg">Property Location</h3>
            <button onclick="toggleMap()" class="btn btn-circle btn-sm">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01" />
              </svg>
            </button>
          </div>
          <div id="mapContainer" class="h-64 rounded-box bg-gray-300 mt-2 hidden">
            <div class="h-full w-full" id="map"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Schedule a Visit Form -->
    <div class="card bg-base-200 mt-6">
      <div class="card-body">
        <h3 class="card-title">Schedule a Visit</h3>
        <form class="space-y-3" id="visitForm">
          {% csrf_token %}
          <div class="form-control">
            <input type="text" name="name" placeholder="Your Name" class="input input-bordered" required/>
          </div>
          <div class="form-control">
            <input type="email" name="email" placeholder="Email" class="input input-bordered" required/>
          </div>
          <div class="form-control">
            <input type="tel" name="phone" placeholder="Phone" class="input input-bordered" required/>
          </div>
          <div class="form-control">
            <input type="date" name="visit_date" class="input input-bordered" required min="{{ today|date:'Y-m-d' }}"/>
          </div>
          <div class="form-control">
            <textarea name="message" class="textarea textarea-bordered" placeholder="Additional notes"></textarea>
          </div>
          <button type="submit" class="btn btn-primary">Request Visit</button>
        </form>
      </div>
    </div>

    <!-- Neighborhood Information -->
    <div class="collapse collapse-plus bg-base-200 mt-6">
      <input type="checkbox" class="peer" checked/> 
      <div class="collapse-title text-lg font-medium">
        Neighborhood Information
      </div>
      <div class="collapse-content"> 
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          {% for feature in neighborhood_features %}
          <div class="flex items-center space-x-2">
            <div class="p-2 rounded-full bg-primary/10 text-primary">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
            </div>
            <div>
              <div class="font-bold">{{ feature.distance }}</div>
              <div class="text-xs">{{ feature.name }}</div>
            </div>
          </div>
          {% empty %}
          <div class="col-span-4 text-gray-500">No neighborhood information available</div>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- Price History Chart -->
    <div class="card bg-base-200 mt-6">
      <div class="card-body">
        <h3 class="card-title">Price History</h3>
        <div class="h-64">
          <canvas id="priceHistoryChart"></canvas>
        </div>
      </div>
    </div>

    <!-- Dynamic Contact Form with Validation -->
    <div class="card bg-primary text-primary-content mt-6" id="contactForm">
      <div class="card-body">
        <h3 class="card-title">Contact Agent</h3>
        <form class="space-y-3" id="contactForm">
          {% csrf_token %}
          <div class="form-control">
            <input type="text" name="name" placeholder="Your Name" class="input input-bordered" required/>
            <label class="label hidden" id="nameError">
              <span class="label-text-alt text-error">Please enter your name</span>
            </label>
          </div>
          <div class="form-control">
            <input type="email" name="email" placeholder="Email" class="input input-bordered" required/>
            <label class="label hidden" id="emailError">
              <span class="label-text-alt text-error">Please enter a valid email</span>
            </label>
          </div>
          <div class="form-control">
            <input type="tel" name="phone" placeholder="Phone" class="input input-bordered" required/>
            <label class="label hidden" id="phoneError">
              <span class="label-text-alt text-error">Please enter your phone number</span>
            </label>
          </div>
          <div class="form-control">
            <textarea name="message" class="textarea textarea-bordered" placeholder="Your Message" required></textarea>
            <label class="label hidden" id="messageError">
              <span class="label-text-alt text-error">Please enter your message</span>
            </label>
          </div>
          <button type="submit" class="btn btn-secondary w-full">Send Message</button>
        </form>
      </div>
    </div>

    <!-- Social Proof Section -->
    <div class="mt-6">
      <h3 class="text-lg font-semibold mb-3">What Others Say</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        {% for testimonial in testimonials %}
        <div class="card bg-base-200">
          <div class="card-body">
            <div class="flex items-center space-x-3">
              <div class="avatar">
                <div class="w-12 rounded-full">
                  <img src="{{ testimonial.avatar_url|default:'https://www.gravatar.com/avatar/default?s=200' }}" 
                       alt="{{ testimonial.name }}"/>
                </div>
              </div>
              <div>
                <h4 class="font-bold">{{ testimonial.name }}</h4>
                <div class="rating rating-sm">
                  {% for i in "12345" %}
                  <input type="radio" name="rating-{{ testimonial.id }}" 
                         class="mask mask-star" {% if forloop.counter <= testimonial.rating %}checked{% endif %}/>
                  {% endfor %}
                </div>
              </div>
            </div>
            <p class="mt-3">"{{ testimonial.comment }}"</p>
          </div>
        </div>
        {% empty %}
        <div class="col-span-2 text-gray-500">No testimonials yet</div>
        {% endfor %}
      </div>
      <div class="mt-4">
        <a href="{% url 'testimonials' %}" class="btn btn-outline btn-sm">
          Add Your Testimonial
        </a>
      </div>
    </div>

    <!-- Similar Properties Section -->
    <div class="mt-16">
      <h2 class="text-2xl font-bold mb-6 text-primary">Similar Properties</h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for similar_property in similar_properties %}
        <div class="card bg-base-100 shadow-xl hover:shadow-2xl transition-shadow duration-300 group">
          <figure class="relative overflow-hidden h-48">
            <img src="{{ similar_property.images.first.image.url }}" 
                 alt="{{ similar_property.title }}" 
                 class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"/>
            {% if similar_property.is_new %}
            <div class="absolute top-3 right-3 badge badge-accent badge-lg">New</div>
            {% endif %}
          </figure>
          <div class="card-body">
            <h3 class="card-title">{{ similar_property.title }}</h3>
            <p class="text-sm text-gray-500">{{ similar_property.location }}</p>
            <div class="flex justify-between items-center mt-2">
              <span class="font-bold text-success">KSh {{ similar_property.price|floatformat:2 }}</span>
              <div class="badge badge-outline">{{ similar_property.bedrooms }} Bed</div>
            </div>
          </div>
        </div>
        {% empty %}
        <div class="col-span-3 text-gray-500">No similar properties found</div>
        {% endfor %}
      </div>
      
      <div class="text-center mt-8">
        <a href="{% url 'listing' %}?location={{ house.location }}&house_type={{ house.house_type }}" 
           class="btn btn-outline btn-primary animate-pulse">
          View All Similar Properties
        </a>
      </div>
    </div>
  </div>
</section>

<!-- JavaScript for enhanced functionality -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap" async defer></script>
<script>
// Auto-scrolling for image carousel
let scrollInterval;
function startAutoScroll() {
  scrollInterval = setInterval(() => {
    const activeSlide = document.querySelector('.carousel-item:not(.hidden)');
    const nextSlide = activeSlide.nextElementSibling || document.querySelector('.carousel-item:first-child');
    const nextId = nextSlide.id;
    document.querySelector(`a[href="#${nextId}"]`).click();
  }, 5000);
}
function pauseAutoScroll() {
  clearInterval(scrollInterval);
}

// Initialize auto-scroll on page load
document.addEventListener('DOMContentLoaded', () => {
  startAutoScroll();
  
  // Initialize price history chart
  const ctx = document.getElementById('priceHistoryChart').getContext('2d');
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: JSON.parse('{{ price_history.labels|escapejs }}'),
      datasets: [{
        label: 'Price (KSh)',
        data: JSON.parse('{{ price_history.data|escapejs }}'),
        borderColor: '#3ABFF8',
        backgroundColor: 'rgba(58, 191, 248, 0.1)',
        tension: 0.1,
        fill: true
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        y: {
          beginAtZero: false
        }
      }
    }
  });
  
  // Form validation for contact form
  document.getElementById('contactForm').addEventListener('submit', function(e) {
    e.preventDefault();
    let valid = true;
    
    // Validate name
    if (!this.name.value.trim()) {
      document.getElementById('nameError').classList.remove('hidden');
      valid = false;
    } else {
      document.getElementById('nameError').classList.add('hidden');
    }
    
    // Validate email
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(this.email.value)) {
      document.getElementById('emailError').classList.remove('hidden');
      valid = false;
    } else {
      document.getElementById('emailError').classList.add('hidden');
    }
    
    // Validate phone
    if (!this.phone.value.trim()) {
      document.getElementById('phoneError').classList.remove('hidden');
      valid = false;
    } else {
      document.getElementById('phoneError').classList.add('hidden');
    }
    
    // Validate message
    if (!this.message.value.trim()) {
      document.getElementById('messageError').classList.remove('hidden');
      valid = false;
    } else {
      document.getElementById('messageError').classList.add('hidden');
    }
    
    if (valid) {
      // Submit form via AJAX
      fetch("{% url 'contact_agent' %}", {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-CSRFToken': '{{ csrf_token }}'
        },
        body: JSON.stringify({
          name: this.name.value,
          email: this.email.value,
          phone: this.phone.value,
          message: this.message.value,
          property_id: "{{ house.id }}"
        })
      })
      .then(response => response.json())
      .then(data => {
        if (data.success) {
          alert('Message sent successfully!');
          this.reset();
        } else {
          alert('Error sending message. Please try again.');
        }
      })
      .catch(error => {
        console.error('Error:', error);
        alert('An error occurred. Please try again.');
      });
    }
  });

  // Form validation for visit form
  document.getElementById('visitForm').addEventListener('submit', function(e) {
    e.preventDefault();
    fetch("{% url 'schedule_visit' %}", {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-CSRFToken': '{{ csrf_token }}'
      },
      body: JSON.stringify({
        name: this.name.value,
        email: this.email.value,
        phone: this.phone.value,
        visit_date: this.visit_date.value,
        message: this.message.value,
        property_id: "{{ house.id }}"
      })
    })
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        alert('Visit request submitted successfully!');
        this.reset();
      } else {
        alert('Error submitting request. Please try again.');
      }
    })
    .catch(error => {
      console.error('Error:', error);
      alert('An error occurred. Please try again.');
    });
  });
  
  // Initialize map (will be shown/hidden by toggle)
  initMap();
});

// Map functions
let map;
function initMap() {
  const location = { lat: {{ house.latitude }}, lng: {{ house.longitude }} };
  map = new google.maps.Map(document.getElementById('map'), {
    center: location,
    zoom: 15,
    styles: [
      {
        featureType: 'poi',
        stylers: [{ visibility: 'off' }]
      },
      {
        featureType: 'transit',
        elementType: 'labels.icon',
        stylers: [{ visibility: 'off' }]
      }
    ]
  });
  new google.maps.Marker({
    position: location,
    map: map,
    title: "{{ house.title }}",
    icon: {
      url: "https://maps.google.com/mapfiles/ms/icons/red-dot.png"
    }
  });
}

function toggleMap() {
  const mapContainer = document.getElementById('mapContainer');
  mapContainer.classList.toggle('hidden');
  if (!mapContainer.classList.contains('hidden')) {
    // Trigger map resize when shown
    setTimeout(() => {
      google.maps.event.trigger(map, 'resize');
      map.setCenter({ lat: {{ house.latitude }}, lng: {{ house.longitude }} });
    }, 100);
  }
}

// Social sharing functions
function shareOnFacebook() {
  window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}`, '_blank', 'width=600,height=400');
}

function shareOnTwitter() {
  window.open(`https://twitter.com/intent/tweet?text=Check%20out%20this%20property:%20{{ house.title|urlencode }}&url=${encodeURIComponent(window.location.href)}`, '_blank', 'width=600,height=400');
}

function shareOnInstagram() {
  // Instagram doesn't support direct web sharing, so we'll provide a copy option
  const text = `Check out this property: {{ house.title }}\n${window.location.href}`;
  navigator.clipboard.writeText(text).then(() => {
    alert('Link copied to clipboard! You can now paste it in Instagram.');
  }).catch(() => {
    prompt('Copy this link to share on Instagram:', window.location.href);
  });
}
</script>
{% endblock %}